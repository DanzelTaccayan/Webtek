<!DOCTYPE html>
<html>
<head>
	<title>Items</title>
</head>
<body>
	Item Descrition: 
	<input type="text" id= "input_description" >
	Item Quantity: 
	<input type="text" id= "input_quantity" >
	<input type="button" id = "add" value="add" onclick = "addItem()">

	<hr>
	<table name ="mytable">
	<tr>
		<th>Item Description</th>
		<th>Item Quantity</th>
	</tr>
	</table>

	<script type="text/javascript">

		var itemsArray = [];

		//when the body of the html loads do this function
		document.body.onload = function() {
			console.log("body loaded");
			if(localStorage.itemsRecord){
				itemsArray = JSON.parse(localStorage.itemsRecord);
				for (var i = 0; i < itemsArray.length; i++) {
					generateTable(itemsArray[i].Description,itemsArray[i].Quantity);
				}
			}
		}

		function addItem() {
            var description = document.getElementById("input_description").value;
            var quantity = document.getElementById("input_quantity").value;               
            var itemsObject = {'Description': description, 'Quantity': quantity}; 
            
            if(description === "" || isNaN(quantity) || quantity === ""){
                alert("Please input a number");
            }else if(validate()){
                alert("not allowed");
            }else{
                var quant = parseInt(quantity);
                var itemsObject = {'Description': description, 'Quantity': quant};
                generateTable(description,quant);
                itemsArray.push(itemsObject);	
                localStorage.itemsRecord = JSON.stringify(itemsArray);
            }
		}

		function generateTable(desc, quantity) {
			//Query table
			var table = document.querySelector("table[name=mytable]");
			//Insert a row into the table
			var tabRow = table.insertRow();

			//Insert into the first and second column of the tabRow var
			var colItemDesc = tabRow.insertCell(0);
			var colItemQuant = tabRow.insertCell(1);

			//put some values
			colItemDesc.textContent = desc;
			colItemQuant.textContent = quantity;

			//Clear the values of the input
			document.getElementById("input_description").value = "";
			document.getElementById("input_quantity").value = "";
		}
		
        function validate(){
            var validate = false;
            var description = document.getElementById("input_description").value;
                for (var i = 0; i < itemsArray.length; i++){
                    if (description === itemsArray[i].Description){
                        validate = true;
                    }

                }
            return validate;
            
        }
        
       
		

	</script>
</body>
</html>